---
const { arrayImagenes } = Astro.props;
interface interfazArrayImagenes {
  url: string;
}
---

<section class="carrusel-container relative w-full h-full overflow-hidden group">
  <div class="swiper carrusel w-full h-full">
    <div class="swiper-wrapper">
      {arrayImagenes.map((imagen: interfazArrayImagenes) => (
        <div class="swiper-slide">
          <img
            class="w-full min-w-full h-full object-contain p-0 shrink-0"
            src={`${imagen.url}?w=700&format=auto`}
            alt=""
            loading="lazy"
          />
        </div>
      ))}
    </div>
  </div>

  <!-- Flecha izquierda -->
  <button
    class="leftArrow absolute -left-10 top-1/2 -translate-y-1/2 z-30 opacity-0 hover:bg-white p-2 group-hover:opacity-100 transition-all duration-200 group-hover:left-1 cursor-pointer hidden md:block"
    aria-label="Imagen anterior"
  >
    <svg
      class="w-6 h-6 rotate-180"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 32 32"
    >
      <path
        fill="currentColor"
        d="M9.91 24.96 19.37 16 9.9 7.04l1.5-1.58L22.54 16 11.41 26.54l-1.5-1.58Z"
      ></path>
    </svg>
  </button>

  <!-- Flecha derecha -->
  <button
    class="rightArrow absolute -right-10 top-1/2 -translate-y-1/2 z-30 opacity-0 p-2 hover:bg-white group-hover:opacity-100 transition-all duration-200 group-hover:right-1 overflow-hidden cursor-pointer hidden md:block"
    aria-label="Imagen siguiente"
  >
    <svg
      class="w-6 h-6"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 32 32"
    >
      <path
        fill="currentColor"
        d="M9.91 24.96 19.37 16 9.9 7.04l1.5-1.58L22.54 16 11.41 26.54l-1.5-1.58Z"
      ></path>
    </svg>
  </button>

  <!-- Boton mas-->
  <button
    class="absolute right-4 top-9 -translate-y-1/2 z-20 cursor-pointer p-2 hover:bg-white hidden md:block"
    aria-label="Abrir"
  >
    <svg
      class="w-6 h-6"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 32 32"
    >
      <path d="M17.1 5.9v9h9v2.2h-9v9h-2.2v-9h-9v-2.2h9v-9h2.2Z"></path>
    </svg>
  </button>
</section>

<script>
  import Swiper from 'swiper';
  import { Navigation } from 'swiper/modules';
  import 'swiper/css';
  import 'swiper/css/navigation';

  document.addEventListener('DOMContentLoaded', () => {
    const containers = document.querySelectorAll('.carrusel-container');
    
    containers.forEach(container => {
      const swiperEl = container.querySelector('.swiper');
      const prevEl = container.querySelector('.leftArrow');
      const nextEl = container.querySelector('.rightArrow');
      
      if (swiperEl && prevEl && nextEl) {
        // Cast a HTMLElement para satisfacer TypeScript
        new Swiper(swiperEl as HTMLElement, {
          modules: [Navigation],
          navigation: {
            prevEl: prevEl as HTMLElement,
            nextEl: nextEl as HTMLElement,
          },
          loop: true,
          speed: 400,
          freeMode: true,
          grabCursor: true,
          slidesPerView: 1,
        });
      }
    });
  });
</script>
