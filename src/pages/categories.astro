---
import CategoriasMenuSticky from "@components/Categorias/CategoriasMenuSticky.astro";
import Layout from "../layouts/Layout.astro";
import CategoriasFiltros from "@components/Categorias/CategoriasFiltros.astro";
import CategoriasFinal from "@components/Categorias/CategoriasFinal.astro";
import CategoriasContenedorCard from "@components/Categorias/CategoriasContenedorCard.astro";

import categoriaVideo from "@assets/CategoriaVideo.webm";



let titulo = "Ropa y Calzado para hombre"
let numeroProductos = 1000

let ArrayTallas = [
    {
        Size: 35,
        Precio: 95,
        Disponibilidad: true
    },
    {
        Size: 36,
        Precio: 95,
        Disponibilidad: true
    },
    {
        Size: 37,
        Precio: 95,
        Disponibilidad: true
    }]





const APIROCKET_ECOMMERCE_TOKEN = import.meta.env.APIROCKET_ECOMMERCE_TOKEN;


let queryCards = `
query MyQuery {
  Products {
    name
    price
    sizes {
      size
    }
    variations {
      arrayImages {
        url
      }
      color
    }
    defaultVariation {
      id
    }
    colors
    arrayImages {
      url
    }
  }
}


`

 
async function fetchApirocket(query: String) {

  const options = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${APIROCKET_ECOMMERCE_TOKEN}`
    },
    body: JSON.stringify({query})
  }

  const data = await fetch('https://graphql.apirocket.io', options).then(response => response.json())
  return data
}

let arrayCards = (await fetchApirocket(queryCards)).data.Products;
let queryColors = `query MyQuery {
  Colors {
    name
    color {
      hex
    }
  }
}

`



let arrayColores = (await fetchApirocket(queryColors)).data.Colors;

let queryText = `query MyQuery {
  TickerTexts {
    text
  }
}
`

let arrayTexto = (await fetchApirocket(queryText)).data.TickerTexts

---

<Layout arrayTexto={arrayTexto} mostrarTicker={true}>
  <CategoriasMenuSticky titulo={titulo}, numeroProductos={numeroProductos} />
  <div class="flex">
    <CategoriasFiltros ArrayTallas={ArrayTallas} arrayColores={arrayColores}/>
    <CategoriasContenedorCard arrayCards={arrayCards}>
  <video autoplay muted loop class="row-start-1 row-end-1 col-start-2 col-end-2 md:col-start-3 md:col-end-3">
              <source src={categoriaVideo} type="video/webm" />

  </video>

    </CategoriasContenedorCard>
  </div>
  <CategoriasFinal numeroProductos={numeroProductos} numeroCards={arrayCards.length} />
</Layout>
